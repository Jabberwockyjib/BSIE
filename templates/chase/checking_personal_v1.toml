# Chase Personal Checking Statement Template v1
# This template handles Chase personal checking account statements

[metadata]
template_id = "chase_checking_personal_v1"
version = "1.0.0"
bank_family = "chase"
statement_type = "checking"
segment = "personal"
description = "Chase personal checking account statements (standard layout)"

[detect]
# Keywords to identify Chase statements
keywords = ["CHASE", "JPMorgan Chase Bank", "Chase Bank"]
keyword_match_threshold = 1

# Header patterns (regex)
header_patterns = [
    "CHASE.*CHECKING",
    "Account\\s+Activity",
    "Previous\\s+Balance"
]

# Required text elements
required_text = ["Account Activity", "Ending Balance"]

# Negative patterns (disqualify if matched)
negative_patterns = [
    "BUSINESS CHECKING",
    "CHASE SAPPHIRE"
]

# Only check first page
detect_pages = [1]

[preprocess]
requires_ocr = "auto"
ocr_engine = "tesseract"
ocr_language = "eng"
ocr_dpi = 300

[preprocess.ocr_detection]
text_density_threshold = 100
embedded_text_confidence_threshold = 0.8

[table]
[table.primary]
anchor_text = "Account Activity"
anchor_position = "above"
anchor_search_pages = [1, 2]
bbox_mode = "anchor_relative"
bbox = [0.0, 0.05, 1.0, 0.85]

[table.multi_page]
continuation_keywords = ["continued", "CONTINUED"]
end_keywords = ["Ending Balance", "ENDING BALANCE"]

[extraction]
method = "hybrid"
primary_extractor = "camelot"
fallback_extractor = "tabula"
confidence_threshold = 0.7

[columns]
expected_count = 4
[columns.map]
date = "Date"
description = "Description"
amount = "Amount"
balance = "Balance"

[parsing]
[parsing.date]
formats = ["%m/%d", "%m/%d/%y", "%m/%d/%Y"]
infer_year = true

[parsing.amount]
decimal_separator = "."
thousands_separator = ","
negative_patterns = ["(", "-"]
credit_keywords = ["deposit", "credit", "transfer in"]
debit_keywords = ["withdrawal", "debit", "transfer out", "fee"]

[normalization]
trim_whitespace = true
normalize_unicode = true
uppercase_description = false

[verification]
balance_reconciliation = true
tolerance = 0.01
require_opening_balance = true
require_closing_balance = true
